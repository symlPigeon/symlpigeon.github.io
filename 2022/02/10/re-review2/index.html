<!-- build time: Wed Sep 10 2025 16:38:05 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><meta name="google-site-verification" content="ZTJV7LmnjnAU0rDyvzCr7TRRA440DNEQPOSHt9OiYLE"><link rel="alternate" href="/rss.xml" title="symlpigeon's little gensokyo" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="symlpigeon's little gensokyo" type="application/atom+xml"><link rel="alternate" type="application/json" title="symlpigeon's little gensokyo" href="http://symlpigeon.github.io/feed.json"><link rel="preconnect" href="https://s4.zstatic.net"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.25"><link rel="modulepreload" href="/js/chunk-4ZVORXXI.js"><link rel="modulepreload" href="/js/chunk-QTIRA53W.js"><link rel="modulepreload" href="/js/copy-tex-SCXHUQKS.js"><link rel="modulepreload" href="/js/post-XSNAZ6TV.js"><link rel="modulepreload" href="/js/quicklink-P2UCCMRY.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="preload" href="/assets/index-bg.jpg" as="image" fetchpriority="high"><meta name="keywords" content="逆向工程,ELF"><meta name="description" content="ELF文件结构。"><link rel="canonical" href="http://symlpigeon.github.io/2022/02/10/re-review2/"><script src="https://cdn.jsdelivr.net/npm/echarts@5.4.0/dist/echarts.min.js"></script><style type="text/css">#categories-chart,#categories-radar,#posts-calendar,#posts-chart,#tags-chart{width:100%;height:300px;margin:.5rem auto;padding:.5rem;overflow-x:auto}</style><title>ELF格式学习</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">ELF格式学习</h1><div class="meta"><span class="item" title="创建时间：2022-02-10 16:01:40"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2022-02-10T16:01:40+08:00">2022-02-10</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>10k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Another Gensokyo</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="/assets/index-bg.jpg" loading="eager" decoding="async" fetchpriority="high" alt="symlpigeon's little gensokyo"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/" itemprop="item" rel="index" title="分类于二进制"><span itemprop="name">二进制<meta itemprop="position" content="0"></span></a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%9F%BA%E7%A1%80/" itemprop="item" rel="index" title="分类于二进制基础"><span itemprop="name">二进制基础<meta itemprop="position" content="1"></span></a></span></div><article class="post block" itemscope itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://symlpigeon.github.io/2022/02/10/re-review2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.png"><meta itemprop="name" content="神隐陌路/symlPigeon"><meta itemprop="description" content="神隐陌路的个人小站, 夢違え、幻の朝靄の世界の記憶を"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="symlpigeon's little gensokyo"></span><div class="body md" itemprop="articleBody"><p>感觉这一节基本上写成文档的翻译了……</p><h1 id="elf文件格式"><a class="anchor" href="#elf文件格式">#</a> ELF 文件格式</h1><p>ELF (Executable and Linking Format) 是 IA-32 架构下的可移植的对象文件格式。</p><p>ELF 文件分为了三个类型：</p><ul><li>可重定向文件 (relocatable file)：包含了代码、数据，用来和其他对象文件链接，构成可执行文件或者共享文件。</li><li>可执行文件 (executable file)：包含了可以执行的程序，这个文件也说明了如何去创建进程的镜像。</li><li>共享对象文件 (shared object file)：可以被链接器和其他的可重定向文件或者共享对象文件创建成新的对象文件。</li></ul><p>对象文件参与程序链接和程序的执行，对于这两件事情，对象文件格式提供了两个并行的视图也就是链接视图和执行视图：</p><p><img loading="lazy" data-src="elf-fmt.jpg" alt=""></p><p>其中，**ELF 头 (ELF header)** 在最开始部分，其中存放了程序的文件组织结构信息。** 节 (section)** 用于链接视图，其中存放了链接视图需要的大部分信息，包括了指令、数据、符号表和重定向信息等等。** 段 (segment)** 则是用于执行视图，包括代码段、数据段等等。</p><p>** 程序头表 (program header table)** 用来告知系统如何去创建一个进程的镜像，如果一个文件需要用来执行（也就是可执行文件），那么它就必须得有一个程序头表，而像可重定向文件就不一定要有。** 节头表 (section header table)** 则是包括了描述文件中各个节的信息，每个节在表中都有对应的一个表项，其中包括节的名称、大小等信息。如果一个文件需要被用来链接，那么它就必须得有节头表。</p><p>在一个 ELF 文件中，上面的这些部分除了 ELF 头必须位于最开始固定的位置，其他的各个部分顺序实际上都是可以打乱的。</p><h2 id="数据类型"><a class="anchor" href="#数据类型">#</a> 数据类型</h2><p>32 位的对象文件中有这些数据类型：</p><table><thead><tr><th>名称</th><th>大小</th><th>对齐</th><th>用途</th></tr></thead><tbody><tr><td><code>Elf32_Addr</code></td><td><code>4</code></td><td><code>4</code></td><td>无符号 程序地址</td></tr><tr><td><code>Elf32_Half</code></td><td><code>2</code></td><td><code>2</code></td><td>无符号 中等大小整数</td></tr><tr><td><code>Elf32_Off</code></td><td><code>4</code></td><td><code>4</code></td><td>无符号 文件偏移</td></tr><tr><td><code>Elf32_Sword</code></td><td><code>4</code></td><td><code>4</code></td><td>有符号 大整数</td></tr><tr><td><code>Elf32_Word</code></td><td><code>4</code></td><td><code>4</code></td><td>无符号 大整数</td></tr><tr><td><code>unsigned char</code></td><td><code>1</code></td><td><code>1</code></td><td>无符号 小整数</td></tr></tbody></table><p>在必要的情况下，数据中会增加填充来保证 4 字节的对象以 4 字节为单位对齐。</p><h2 id="elf头"><a class="anchor" href="#elf头">#</a> ELF 头</h2><p>ELF 头的定义如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EI_NIDENT</span>   <span class="token expression"><span class="token number">16</span></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span>   e_ident<span class="token punctuation">[</span>EI_NIDENT<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    Elf32_Half      e_type<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    Elf32_Half      e_machine<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    Elf32_Word      e_version<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    Elf32_Addr      e_entry<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    Elf32_Off       e_phoff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    Elf32_Off       e_shoff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    Elf32_Word      e_flags<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    Elf32_Half      e_ehsize<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    Elf32_Half      e_phentsize<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    Elf32_Half      e_phnum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    Elf32_Half      e_shentsize<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    Elf32_Half      e_shnum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    Elf32_Half      e_shstrndx<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>这些字段的作用分别是：</p><h3 id="e_ident"><a class="anchor" href="#e_ident">#</a> e_ident</h3><p>全名是 ELF Identification，实际上就是 magic number 和一些其他的信息，用来标识文件的类型是对象文件，还有机器无关的数据用来解码和翻译文件的内容。</p><p>ELF 文件格式这个框架实际上是支持多种处理器架构和编码方式的， <code>e_ident</code> 这个字段的作用也就是为了这个兼容性。</p><p>e_ident 的前四字节就是 magic number，用来标识这个文件是 ELF 文件：</p><table><thead><tr><th>名称</th><th>值</th></tr></thead><tbody><tr><td><code>ELFMAG0</code></td><td>0x7f</td></tr><tr><td><code>ELFMAG1</code></td><td>'E'(0x45)</td></tr><tr><td><code>ELFMAG2</code></td><td>'L'(0x4c)</td></tr><tr><td><code>ELFMAG3</code></td><td>'F'(0x46)</td></tr></tbody></table><p>第五个字节即 e_ident [4] 是 <code>EI_CLASS</code> ，标识了文件对象是 32 位或是 64 位：</p><table><thead><tr><th>名称</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>ELFCLASSNONE</code></td><td>0</td><td>无效的文件类型</td></tr><tr><td><code>ELFCLASS32</code></td><td>1</td><td>32 位文件</td></tr><tr><td><code>ELFCLASS64</code></td><td>2</td><td>64 位文件</td></tr></tbody></table><p>第六个字节即 e_ident [5] 是 <code>EI_DATA</code> ，标识了文件对象的字节序：</p><table><thead><tr><th>名称</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>ELFDATANONE</code></td><td>0</td><td>无效的字节序</td></tr><tr><td><code>ELFDATA2LSB</code></td><td>1</td><td>小端字节序</td></tr><tr><td><code>ELFDATA2MSB</code></td><td>2</td><td>大端字节序</td></tr></tbody></table><p>第七个字节即 e_ident [6] 为 <code>EI_VERSION</code> ，即 ELF 的文件版本。</p><p><code>e_ident</code> 中的剩余部分为 <code>EI_PAD</code> ，作为保留部分填充为 0，尚未使用。</p><p>以一个程序为例，我们使用 readelf 读取其 ELF 头部分信息，其中 e_ident 字段和其中的解析结果为：</p><pre><code>7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
类别:                              ELF64
数据:                              2 补码，小端序 (little endian)
Version:                          1 (current)
</code></pre><p><img loading="lazy" data-src="e_ident.jpg" alt=""></p><p>还挺清楚的哈。</p><h3 id="e_type"><a class="anchor" href="#e_type">#</a> e_type</h3><p>这个字段标识了对象文件的类型：</p><table><thead><tr><th>名称</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>ET_NONE</code></td><td>0</td><td>无类型</td></tr><tr><td><code>ET_REL</code></td><td>1</td><td>可重定位文件</td></tr><tr><td><code>ET_EXEC</code></td><td>2</td><td>可执行文件</td></tr><tr><td><code>ET_DYN</code></td><td>3</td><td>共享对象文件</td></tr><tr><td><code>ET_CORE</code></td><td>4</td><td>核心转储</td></tr><tr><td><code>ET_LOPROC</code></td><td>0xff00</td><td>针对处理器特定</td></tr><tr><td><code>ET_HIPROC</code></td><td>0xffff</td><td>针对处理器特定</td></tr></tbody></table><h3 id="e_machine"><a class="anchor" href="#e_machine">#</a> e_machine</h3><p>这个字段标识了文件对应的处理器架构：</p><table><thead><tr><th>名称</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td><code>EM_NONE</code></td><td>0</td><td>无</td></tr><tr><td><code>EM_M32</code></td><td>1</td><td>AT&amp;T WE 32100</td></tr><tr><td><code>EM_SPARC</code></td><td>2</td><td>SPARC</td></tr><tr><td><code>EM_386</code></td><td>3</td><td>Intel 架构</td></tr><tr><td><code>EM_68K</code></td><td>4</td><td>Motorola 68000</td></tr><tr><td><code>EM_88K</code></td><td>5</td><td>Motorola 88000</td></tr><tr><td><code>EM_860</code></td><td>7</td><td>Intel 80860</td></tr><tr><td><code>EM_MIPS</code></td><td>8</td><td>MIPS RS3000 大端序</td></tr><tr><td><code>EM_MIPS_RS4_BE</code></td><td>10</td><td>MIPS RS4000 大端序</td></tr><tr><td><code>RESERVED</code></td><td>11-16</td><td>保留</td></tr></tbody></table><h3 id="e_version"><a class="anchor" href="#e_version">#</a> e_version</h3><p>这个字段指定了对象文件的版本。包括了两个值： <code>EV_NONE</code> 即 0，代表无效版本； <code>EV_CURRENT</code> 即 1 代表了当前版本。</p><h3 id="e_entry"><a class="anchor" href="#e_entry">#</a> e_entry</h3><p>这个字段给了系统转交控制的虚拟地址，也就是进程开始的地址。</p><p>如果程序没有入口点，那么这个参数的字段就是 0。</p><h3 id="e_phoff"><a class="anchor" href="#e_phoff">#</a> e_phoff</h3><p>这个字段是程序头表位置的偏移量。如果没有程序头表，那么这个字段值为 0。</p><h3 id="e_shoff"><a class="anchor" href="#e_shoff">#</a> e_shoff</h3><p>这个字段是节头表位置的偏移量。如果没有节头表，那么这个字段值为 0。</p><h3 id="e_flags"><a class="anchor" href="#e_flags">#</a> e_flags</h3><p>这个字段是文件有关的处理器特定的标识。</p><h3 id="e_ehsize"><a class="anchor" href="#e_ehsize">#</a> e_ehsize</h3><p>这个字段是 ELF 头的长度（以字节为单位）</p><h3 id="e_phentsize"><a class="anchor" href="#e_phentsize">#</a> e_phentsize</h3><p>这个字段是文件的程序头表中一个条目的长度，以字节为单位。表中的每个条目的长度都是相等的。</p><h3 id="e_phnum"><a class="anchor" href="#e_phnum">#</a> e_phnum</h3><p>这个字段标识了程序头表中的条目数。如果没有程序头表，那么这个字段值为 0。通过和 e_phentsize 字段相乘，可以计算出程序头表的大小。</p><h3 id="e_shentsize"><a class="anchor" href="#e_shentsize">#</a> e_shentsize</h3><p>这个字段是文件的节头表中一个条目的长度，和前面的类似。</p><h3 id="e_shnum"><a class="anchor" href="#e_shnum">#</a> e_shnum</h3><p>这个字段是节头表中的条目数，和前面计算类似。</p><p>找了一个例子：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>gcc hello.c <span class="token parameter variable">-o</span> hello <span class="token parameter variable">-mtune</span><span class="token operator">=</span>i386 <span class="token parameter variable">-m32</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>$ hexdump <span class="token parameter variable">-C</span> <span class="token parameter variable">-n</span> <span class="token number">52</span> hello                                                                                                             <span class="token number">0</span> <span class="token punctuation">[</span><span class="token number">23</span>:33:44<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>00000000  7f <span class="token number">45</span> 4c <span class="token number">46</span> 01 01 01 00  00 00 00 00 00 00 00 00  <span class="token operator">|</span>.ELF<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token operator">|</span></pre></td></tr><tr><td data-num="5"></td><td><pre>00000010  03 00 03 00 01 00 00 00  <span class="token number">60</span> <span class="token number">10</span> 00 00 <span class="token number">34</span> 00 00 00  <span class="token operator">|</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>`<span class="token punctuation">..</span>.4<span class="token punctuation">..</span>.<span class="token operator">|</span></pre></td></tr><tr><td data-num="6"></td><td><pre>00000020  9c <span class="token number">36</span> 00 00 00 00 00 00  <span class="token number">34</span> 00 <span class="token number">20</span> 00 0c 00 <span class="token number">28</span> 00  <span class="token operator">|</span>.6<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">4</span>. <span class="token punctuation">..</span>.<span class="token punctuation">(</span>.<span class="token operator">|</span></pre></td></tr><tr><td data-num="7"></td><td><pre>00000030  1e 00 1d 00                                       <span class="token operator">|</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token operator">|</span></pre></td></tr><tr><td data-num="8"></td><td><pre>00000034</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>ELF 头：</pre></td></tr><tr><td data-num="11"></td><td><pre>  Magic：  7f <span class="token number">45</span> 4c <span class="token number">46</span> 01 01 01 00 00 00 00 00 00 00 00 00 </pre></td></tr><tr><td data-num="12"></td><td><pre>  类别:                              ELF32</pre></td></tr><tr><td data-num="13"></td><td><pre>  数据:                              <span class="token number">2</span> 补码，小端序 <span class="token punctuation">(</span>little endian<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  Version:                           <span class="token number">1</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  OS/ABI:                            UNIX - System V</pre></td></tr><tr><td data-num="16"></td><td><pre>  ABI 版本:                          <span class="token number">0</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  类型:                              DYN <span class="token punctuation">(</span>共享目标文件<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  系统架构:                          Intel <span class="token number">80386</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  版本:                              0x1</pre></td></tr><tr><td data-num="20"></td><td><pre>  入口点地址：              0x1060</pre></td></tr><tr><td data-num="21"></td><td><pre>  程序头起点：              <span class="token number">52</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  Start of section headers:          <span class="token number">13980</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  标志：             0x0</pre></td></tr><tr><td data-num="24"></td><td><pre>  Size of this header:               <span class="token number">52</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  Size of program headers:           <span class="token number">32</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  Number of program headers:         <span class="token number">12</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  Size of section headers:           <span class="token number">40</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  Number of section headers:         <span class="token number">30</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  Section header string table index: <span class="token number">29</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="elf-header-full.jpg" alt=""></p><p>作为对照，可以看到 ELF 头各个字段的意义。注意，这里数据是小端序的，比如说 <code>60100000</code> 实际上是 <code>0x00001060</code> ，需要区分一下。</p><h2 id="节头表"><a class="anchor" href="#节头表">#</a> 节头表</h2><p>对象文件的节头表是一系列 <code>Elf32_Shdr</code> 结构体构成的数组，给出了各个节的相关信息。</p><p>这个数组中一些下标是保留的，对象文件不能使用这些下标：</p><table><thead><tr><th>名称</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td><code>SHN_UNDEF</code></td><td>0</td><td>未定义、缺失、无意义等</td></tr><tr><td><code>SHN_LORESERVE</code></td><td>0xff00</td><td>指定了保留下标的下界</td></tr><tr><td><code>SHN_LOPROC</code> ~ <code>SHN_HIPROC</code></td><td>0xff00~0xff1f</td><td>保留给处理器特定的语义</td></tr><tr><td><code>SHN_ABS</code></td><td>0xfff1</td><td>指定了相应参考的绝对值。相对于这个节号定义的符号不受到重定位的影响</td></tr><tr><td><code>SHN_COMMON</code></td><td>0xfff2</td><td>通用符号</td></tr><tr><td><code>SHN_HIRESERVE</code></td><td>0xffff</td><td>指定了保留下标的上界</td></tr></tbody></table><p>节中包括了对象文件除了 ELF 头、程序头表和节头表之外的所有信息。节还需要满足这些条件：</p><ul><li>每个节都有一个来描述它的节头（可能存在一个节头没有对应的节）。</li><li>每个节都占据一段连续字节的空间（也可能是 0）。</li><li>节不能重叠。</li><li>头部和节可能不会覆盖文件中的所有空间。</li></ul><p>节头的数据结构定义如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  Elf32_Word  sh_name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  Elf32_Word  sh_type<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  Elf32_Word  sh_flags<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  Elf32_Addr  sh_addr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  Elf32_Off   sh_offset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  Elf32_Word  sh_size<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  Elf32_Word  sh_link<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  Elf32_Word  sh_info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  Elf32_Word  sh_addralign<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  Elf32_Word  sh_entsize<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span> Elf32_Shdr<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="具体属性定义"><a class="anchor" href="#具体属性定义">#</a> 具体属性定义</h3><h4 id="sh_name"><a class="anchor" href="#sh_name">#</a> sh_name</h4><p>这个字段是节的名字，其中的值这是指向节头的字符串节的地址，对应一个以 0 结尾的字符串。</p><h4 id="sh_type"><a class="anchor" href="#sh_type">#</a> sh_type</h4><p>这个字段表述了节的内容和语义。其中包括了下面这些类型：</p><table><thead><tr><th>名称</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td><code>SHT_NULL</code></td><td>0</td><td>这个节头是 inactive 的，没有其对应的节</td></tr><tr><td><code>SHT_PROGBITS</code></td><td>1</td><td>这个节是程序定义的信息，格式和意义取决于程序</td></tr><tr><td><code>SHT_SYMTAB</code></td><td>2</td><td>符号表</td></tr><tr><td><code>SHT_STRTAB</code></td><td>3</td><td>字符串表</td></tr><tr><td><code>SHT_RELA</code></td><td>4</td><td>有确定的加数的重定位信息，如 <code>ELF32_Rela</code></td></tr><tr><td><code>SHT_HASH</code></td><td>5</td><td>符号哈希表</td></tr><tr><td><code>SHT_DYNAMIC</code></td><td>6</td><td>动态链接信息</td></tr><tr><td><code>SHT_NOTE</code></td><td>7</td><td>文件标记信息 (information that mark the file)</td></tr><tr><td><code>SHT_NOBITS</code></td><td>8</td><td>在文件中不占用空间，其他类似 <code>SHT_PROGBITS</code> 。尽管这个节不会占据空间，它也会有一个理论上的大小。</td></tr><tr><td><code>SHT_REL</code></td><td>9</td><td>没有确定加数的重定位信息，如 <code>ELF32_Rel</code></td></tr><tr><td><code>SHT_SHLIB</code></td><td>10</td><td>保留</td></tr><tr><td><code>SHT_DYNSYM</code></td><td>11</td><td>符号表</td></tr><tr><td><code>SHT_LOPROC</code> ~ <code>SHT_HIPROC</code></td><td>0x70000000~0x7fffffff</td><td>保留给处理器特定</td></tr><tr><td><code>SHT_LOUSER</code></td><td>0x80000000</td><td>为程序保留的地址的下界</td></tr><tr><td><code>SHT_HIUSER</code></td><td>0xffffffff</td><td>为程序保留的地址的上界</td></tr></tbody></table><h4 id="sh_flags"><a class="anchor" href="#sh_flags">#</a> sh_flags</h4><p>表示了各种杂项的 1 比特标识：</p><table><thead><tr><th>名称</th><th>值</th><th>作用</th></tr></thead><tbody><tr><td><code>SHF_WRITE</code></td><td>0x1</td><td>节中存放了在进程执行时可写的数据.</td></tr><tr><td><code>SHF_ALLOC</code></td><td>0x2</td><td>标识了这个节在程序运行时是否会占据内存。有一些控制节是不会驻留在内存镜像中的，这些节的这个属性就会被关闭.</td></tr><tr><td><code>SHF_EXECINSTR</code></td><td>0x4</td><td>标识了这个节含有可执行的机器指令.</td></tr><tr><td><code>SHF_MASKPROC</code></td><td>0xf0000000</td><td>保留给处理器</td></tr></tbody></table><h4 id="sh_addr"><a class="anchor" href="#sh_addr">#</a> sh_addr</h4><p>如果一个节在会出现在进程的内存镜像中，那么这个成员的值就是节中第一个字节在内存中的地址，否则就是 0。</p><h4 id="sh_offset"><a class="anchor" href="#sh_offset">#</a> sh_offset</h4><p>从文件开始到这个节头对应的节的第一个字节的偏移量。</p><p>上面提到了不占据空间的 <code>SHT_NOBITS</code> 类型，对于这种类型，这个成员的值是这个节在理论上占据的位置。</p><h4 id="sh_size"><a class="anchor" href="#sh_size">#</a> sh_size</h4><p>这个成员以字节为单位给出了节的大小。如果是不占据空间的 <code>SHT_NOBITS</code> 节，这个属性也可能不为 0，只是实际上这个节不占据空间罢了。</p><h4 id="sh_link和sh_info"><a class="anchor" href="#sh_link和sh_info">#</a> sh_link 和 sh_info</h4><p><code>sh_link</code> 是节头表的索引链接， <code>sh_info</code> 是这个节的额外信息。这两个字段的含义取决于节的类型：</p><p>| <code>sh_type</code> | <code>sh_link</code> | <code>sh_info</code> |<br>| <code>SHT_DYNAMIC</code> | 这个节中条目使用到的字符串表在节头表中的下标 | 0|<br>| <code>SHT_HASH</code> | 这个节中哈希表应用到的符号表在节头表中的下标 | 0|<br>| <code>SHT_REL</code> 和 <code>SHT_RELA</code> | 相关的符号表在节头表中的下标 | 重定向影响到的节在节头表中的下标 |<br>| <code>SHT_SYMTAB</code> 和 <code>SHT_DYNSYM</code> | 内容和操作系统有关 | 内容和操作系统有关 |<br>| 其他 | <code>SHN_UNDEF</code> |0|</p><h4 id="sh_addralign"><a class="anchor" href="#sh_addralign">#</a> sh_addralign</h4><p>有一些节要求地址对其。这个属性给出了对齐的单位， <code>sh_addr</code> 属性必须是这个值的整数倍。</p><p>这个属性的值应该是 0 或者 2 的整数次幂，如果值为 0 或者 1，则表示不需要对齐。</p><h4 id="sh_entsize"><a class="anchor" href="#sh_entsize">#</a> sh_entsize</h4><p>如符号表等一些节中的内容是固定长度的一系列条目，对于这样的节，这个属性给出了以字节为单位的每个条目的大小。如果是 0，则表示这个节中没有放置固定长度条目表。</p><h3 id="index-0-节"><a class="anchor" href="#index-0-节">#</a> Index 0 节</h3><p>前面提到了下标为 0 的节是 <code>SHN_UNDEF</code> ，但是这个节实际上是存在的，也就是说比如这个程序有 4 个节，那么下标是 0～3，其中也就包括了这个 <code>SHN_UNDEF</code> 。</p><p>其中的条目是这样的：</p><table><thead><tr><th>属性</th><th>值</th><th>作用</th></tr></thead><tbody><tr><td><code>sh_name</code></td><td>0</td><td>没有名称</td></tr><tr><td><code>sh_type</code></td><td><code>SHT_NULL</code></td><td>inactive</td></tr><tr><td><code>sh_flags</code></td><td>0</td><td>没有标志</td></tr><tr><td><code>sh_addr</code></td><td>0</td><td>没有地址</td></tr><tr><td><code>sh_offset</code></td><td>0</td><td>没有偏移</td></tr><tr><td><code>sh_size</code></td><td>0</td><td>没有大小</td></tr><tr><td><code>sh_link</code></td><td><code>SHN_UNDEF</code></td><td>没有链接</td></tr><tr><td><code>sh_info</code></td><td>0</td><td>没有信息</td></tr><tr><td><code>sh_addralign</code></td><td>0</td><td>没有对齐</td></tr><tr><td><code>sh_entsize</code></td><td>0</td><td>没有条目</td></tr></tbody></table><p>总之啥也没有。</p><h3 id="特殊的节"><a class="anchor" href="#特殊的节">#</a> 特殊的节</h3><p>可执行文件的创建过程需要经过链接，链接器可以解决不同对象文件之间的依赖关系、调整对象文件之间的引用并重定位代码。这一个过程需要一些特定的节内部存储的信息，如 <code>.dynamic</code> 节中的信息。</p><p>实际上，操作系统支持两种链接方式，即动态链接和静态链接。</p><ul><li>静态链接：静态地绑定一系列的对象文件、系统库和其他的库文件，解析引用关系并且创建一个自包含的可执行文件。</li><li>动态链接：将一系列对象文件、库、系统资源和其他的共享库链接在一起创建一个可执行文件。在加载这个可执行文件的时候，那些动态链接库和共享资源也必须可用。</li></ul><p>此外，还有一些节用来支持调试、程序控制等等。</p><p><img loading="lazy" data-src="spec-section.jpg" alt=""></p><p>下面是这些节的作用：</p><h4 id="bss"><a class="anchor" href="#bss">#</a> .bss</h4><p>这个节存储了没有初始化的全局数据，在程序开始运行时，系统会将这些数据置为 0。</p><p>这个节实际并不占据文件空间（ <code>SHT_NOBITS</code> ）。</p><h4 id="comment"><a class="anchor" href="#comment">#</a> .comment</h4><p>包含了版本控制信息</p><h4 id="data和data1"><a class="anchor" href="#data和data1">#</a> .data 和.data1</h4><p>包含了已经初始化的全局数据。</p><h4 id="debug"><a class="anchor" href="#debug">#</a> .debug</h4><p>包含了用于符号调试的信息。</p><h4 id="dynamic"><a class="anchor" href="#dynamic">#</a> .dynamic</h4><p>包含了动态链接信息。</p><h4 id="hash"><a class="anchor" href="#hash">#</a> .hash</h4><p>表明这个节里面有符号哈希表。</p><h4 id="line"><a class="anchor" href="#line">#</a> .line</h4><p>包含了用于调试的行号等信息。</p><h4 id="note"><a class="anchor" href="#note">#</a> .note</h4><p>包含了程序文件标记相关的信息。</p><h4 id="rodata和rodata1"><a class="anchor" href="#rodata和rodata1">#</a> .rodata 和.rodata1</h4><p>程序中的只读数据。</p><h4 id="shstrtab"><a class="anchor" href="#shstrtab">#</a> .shstrtab</h4><p>节的名称。</p><h4 id="strtab"><a class="anchor" href="#strtab">#</a> .strtab</h4><p>这个节中包括了主要是和符号表有关的字符串。</p><h4 id="symtab"><a class="anchor" href="#symtab">#</a> .symtab</h4><p>这个节中包括了符号表。</p><h4 id="text"><a class="anchor" href="#text">#</a> .text</h4><p>这个节中包括了可执行的指令。</p><p>以一个程序（ <code>readelf -S</code> ）为例，其中包括了下面这些节：</p><p><img loading="lazy" data-src="section-type.jpg" alt=""></p><h3 id="字符串表"><a class="anchor" href="#字符串表">#</a> 字符串表</h3><p>字符串表中存储的是以零字符结尾的字符串，其中包括了符号的名字、节的名字等等。对于字符串表的引用就是一个在字符串表中的下标。</p><p>字符串表的第一个字符是零字符，如果一个名称指向这个字符，则表示没有名称或者这个名称为空。同时，字符串表最后一个字符是零字符，这样的目的是使得所有的字符串都能够正常结束。</p><p>实际上字符串表可以为空（其 <code>sh_size</code> 字段为 0），这样，但是所有对这个字符串表的引用下标必须都是 0。</p><p>通过 <code>readelf -x</code> 命令读取字符串表 <code>.strtab</code> 所在的节，能够得到下面的信息：</p><p><img loading="lazy" data-src="strtab.jpg" alt=""></p><p>可以看到其开头和结尾都是字节 0x00，每个字符串的结束也都是字节 0x00。</p><h2 id="程序头表"><a class="anchor" href="#程序头表">#</a> 程序头表</h2><p>程序头表中存储的一系列数据结构可以用来告知系统执行这个程序需要那些信息。表中的每一个条目代表了对应的一个段的有关信息，一个段可以包括多个节。</p><p>程序头表中单个的数据结构定义是这样的：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  ELF32_Word  p_type<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  ELF32_Off   p_offset<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  ELF32_Addr  p_vaddr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  ELF32_Addr  p_paddr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  ELF32_Word  p_filesz<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  ELF32_Word  p_memsz<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  ELF32_Word  p_flags<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  ELF32_Word  p_align<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>其中各个字段的作用如下：</p><table><thead><tr><th>字段名称</th><th>描述</th></tr></thead><tbody><tr><td><code>p_type</code></td><td>对应的段的类型或者如何解释这个段中的元素</td></tr><tr><td><code>p_offset</code></td><td>段第一个字节相对于文件开始位置的偏移</td></tr><tr><td><code>p_vaddr</code></td><td>段在内存中驻留的第一个字节的位置</td></tr><tr><td><code>p_paddr</code></td><td>在物理寻址相关的系统上，用来作为段的物理地址（针对特定系统）</td></tr><tr><td><code>p_filesz</code></td><td>以字节为单位的，段的大小（可以是 0）</td></tr><tr><td><code>p_memsz</code></td><td>以字节为单位的，段需要占据的内存空间（可以是 0）</td></tr><tr><td><code>p_flags</code></td><td>段的标志</td></tr><tr><td><code>p_align</code></td><td>段对齐，具体和前面节的对齐类似</td></tr></tbody></table><h3 id="p_type"><a class="anchor" href="#p_type">#</a> p_type</h3><p>根据 <code>p_type</code> 的取值，段有这些类型：</p><table><thead><tr><th>类型</th><th>值</th><th>描述</th></tr></thead><tbody><tr><td><code>PT_NULL</code></td><td>0</td><td>未使用或者未定义的。</td></tr><tr><td><code>PT_LOAD</code></td><td>1</td><td>表明一个可以加载的段，这个段中的字节会映射到内存中。如果段分配的内存大于文件实际的大小，多余的空间会被置 0。当然分配的内存空间一定要大于文件中段的大小。数据段、代码段都是这种类型。</td></tr><tr><td><code>PT_DYNAMIC</code></td><td>2</td><td>标记了动态链接信息。</td></tr><tr><td><code>PT_INTERP</code></td><td>3</td><td>其中指明了解释器的路径。</td></tr><tr><td><code>PT_NOTE</code></td><td>4</td><td>指明了辅助信息的位置和文件的大小。</td></tr><tr><td><code>PT_SHLIB</code></td><td>5</td><td>保留。</td></tr><tr><td><code>PT_PHDR</code></td><td>6</td><td>指明了在文件中和在内存中程序头表的位置和大小。</td></tr><tr><td><code>PT_LOPROC</code> ~ <code>PT_HIPROC</code></td><td>0x70000000~0x7fffffff</td><td>保留给处理器特定语义</td></tr></tbody></table><p>通过 <code>readelf -l</code> 读取一个程序的程序头表信息：</p><p><img loading="lazy" data-src="segments.jpg" alt=""></p><h1 id="总结"><a class="anchor" href="#总结">#</a> 总结</h1><p>这边其实还有好多可以说的内容，比如说 ELF 的符号表、重定向这些，以及程序的链接和装载等，以后开一个坑出来专门讲。</p><h1 id="参考资料"><a class="anchor" href="#参考资料">#</a> 参考资料</h1><p>[1] 《软件逆向工程 —— 原理与实践》，孙聪 等著，西安电子科技大学出版社。</p><p>[2] Tool Interface Standard (TIS) Executable and Linking Format (ELF) Specification, v1.2</p><div class="tags"><a href="/tags/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" rel="tag"><i class="ic i-tag"></i>逆向工程</a><a href="/tags/x86/" rel="tag"><i class="ic i-tag"></i>x86</a><a href="/tags/ELF/" rel="tag"><i class="ic i-tag"></i>ELF</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-eye"></i></span><span class="text">总访问量：</span><span class="waline-pageview-count" id="twikoo_visitors" data-path="/2022/02/10/re-review2/">加载中...</span></span><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于 </span><time title="修改时间：2025-09-10 14:48:49" itemprop="dateModified" datetime="2025-09-10T14:48:49+08:00">2025-09-10</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>神隐陌路/symlPigeon<i class="ic i-at"><em>@</em></i>symlpigeon's little gensokyo</li><li class="link"><strong>本文链接：</strong><a href="http://symlpigeon.github.io/2022/02/10/re-review2/" title="ELF格式学习">http://symlpigeon.github.io/2022/02/10/re-review2/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/02/07/mpc-1/" rel="prev" itemprop="url" data-background-image="&#x2F;assets&#x2F;bgimgs&#x2F;9bd9b167gy1fwsihw1c64j21hc0u0x6q.jpg" title="安全多方计算——定义、原语"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>安全计算</span><h3>安全多方计算——定义、原语</h3></a></div><div class="item right"><a href="/2022/02/15/re-call/" rel="next" itemprop="url" data-background-image="&#x2F;assets&#x2F;bgimgs&#x2F;a15b4afegy1fmvjk8e18pj21hc0u019s.jpg" title="关于x86调用惯例是啥这件事"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>二进制基础</span><h3>关于x86调用惯例是啥这件事</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#elf%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">ELF 文件格式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#elf%E5%A4%B4"><span class="toc-number">1.2.</span> <span class="toc-text">ELF 头</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#e_ident"><span class="toc-number">1.2.1.</span> <span class="toc-text">e_ident</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_type"><span class="toc-number">1.2.2.</span> <span class="toc-text">e_type</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_machine"><span class="toc-number">1.2.3.</span> <span class="toc-text">e_machine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_version"><span class="toc-number">1.2.4.</span> <span class="toc-text">e_version</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_entry"><span class="toc-number">1.2.5.</span> <span class="toc-text">e_entry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_phoff"><span class="toc-number">1.2.6.</span> <span class="toc-text">e_phoff</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_shoff"><span class="toc-number">1.2.7.</span> <span class="toc-text">e_shoff</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_flags"><span class="toc-number">1.2.8.</span> <span class="toc-text">e_flags</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_ehsize"><span class="toc-number">1.2.9.</span> <span class="toc-text">e_ehsize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_phentsize"><span class="toc-number">1.2.10.</span> <span class="toc-text">e_phentsize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_phnum"><span class="toc-number">1.2.11.</span> <span class="toc-text">e_phnum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_shentsize"><span class="toc-number">1.2.12.</span> <span class="toc-text">e_shentsize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e_shnum"><span class="toc-number">1.2.13.</span> <span class="toc-text">e_shnum</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%82%E5%A4%B4%E8%A1%A8"><span class="toc-number">1.3.</span> <span class="toc-text">节头表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%B9%89"><span class="toc-number">1.3.1.</span> <span class="toc-text">具体属性定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_name"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">sh_name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_type"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">sh_type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_flags"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">sh_flags</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_addr"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">sh_addr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_offset"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">sh_offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_size"><span class="toc-number">1.3.1.6.</span> <span class="toc-text">sh_size</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_link%E5%92%8Csh_info"><span class="toc-number">1.3.1.7.</span> <span class="toc-text">sh_link 和 sh_info</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_addralign"><span class="toc-number">1.3.1.8.</span> <span class="toc-text">sh_addralign</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sh_entsize"><span class="toc-number">1.3.1.9.</span> <span class="toc-text">sh_entsize</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#index-0-%E8%8A%82"><span class="toc-number">1.3.2.</span> <span class="toc-text">Index 0 节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84%E8%8A%82"><span class="toc-number">1.3.3.</span> <span class="toc-text">特殊的节</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#bss"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">.bss</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#comment"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">.comment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#data%E5%92%8Cdata1"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">.data 和.data1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#debug"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">.debug</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dynamic"><span class="toc-number">1.3.3.5.</span> <span class="toc-text">.dynamic</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hash"><span class="toc-number">1.3.3.6.</span> <span class="toc-text">.hash</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#line"><span class="toc-number">1.3.3.7.</span> <span class="toc-text">.line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#note"><span class="toc-number">1.3.3.8.</span> <span class="toc-text">.note</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rodata%E5%92%8Crodata1"><span class="toc-number">1.3.3.9.</span> <span class="toc-text">.rodata 和.rodata1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shstrtab"><span class="toc-number">1.3.3.10.</span> <span class="toc-text">.shstrtab</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#strtab"><span class="toc-number">1.3.3.11.</span> <span class="toc-text">.strtab</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#symtab"><span class="toc-number">1.3.3.12.</span> <span class="toc-text">.symtab</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#text"><span class="toc-number">1.3.3.13.</span> <span class="toc-text">.text</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8"><span class="toc-number">1.3.4.</span> <span class="toc-text">字符串表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%A4%B4%E8%A1%A8"><span class="toc-number">1.4.</span> <span class="toc-text">程序头表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#p_type"><span class="toc-number">1.4.1.</span> <span class="toc-text">p_type</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">3.</span> <span class="toc-text">参考资料</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/01/20/re-review1/" rel="bookmark" title="IA32内存、寄存器、数据">IA32内存、寄存器、数据</a></li><li class="active"><a href="/2022/02/10/re-review2/" rel="bookmark" title="ELF格式学习">ELF格式学习</a></li><li><a href="/2022/02/15/re-call/" rel="bookmark" title="关于x86调用惯例是啥这件事">关于x86调用惯例是啥这件事</a></li><li><a href="/2022/03/22/program-start/" rel="bookmark" title="关于一个ELF程序是怎么启动的这件事以及尝试分析然后大失败的结果">关于一个ELF程序是怎么启动的这件事以及尝试分析然后大失败的结果</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="神隐陌路/symlPigeon" src="/assets/avatar.png"><p class="name" itemprop="name">神隐陌路/symlPigeon</p><div class="description" itemprop="description">夢違え、幻の朝靄の世界の記憶を</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">51</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">36</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">45</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/symlpigeon" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;symlpigeon"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=540913144" class="item music" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;540913144"><i class="ic i-cloud-music"></i></a><a href="mailto:2163953074@qq.com" class="item email" title="mailto:2163953074@qq.com"><i class="ic i-envelope"></i></a><a target="_blank" rel="noopener" href="https://stackoverflow.com/users/20091462/symlpigeon" class="item stackoverflow" title="https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;20091462&#x2F;symlpigeon"><i class="ic i-stack-overflow"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="#" onclick="return!1"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/statistics/" rel="section"><i class="ic i-clock"></i>统计</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/02/15/re-call/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/02/07/mpc-1/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2021 -<span itemprop="copyrightYear">2025</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">神隐陌路/symlPigeon @ Another Gensokyo</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">421k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">6:23</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div><script src="https://unpkg.com/busuanzi@2.3.0/bsz.pure.mini.js"></script><div id="busuanzi-wrap"><span class="ic i-eye"></span><span id="busuanzi_container_site_pv">本站访问量 <span id="busuanzi_value_site_pv"></span> 次</span> | <span class="ic i-user"></span><span id="busuanzi_container_site_uv">本站访客量 <span id="busuanzi_value_site_uv"></span> 次</span></div></div></footer></div><script data-config type="text/javascript">var LOCAL={ispost:!0,path:"2022/02/10/re-review2/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},nocopy:"false",nocopy:!1,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',copy_tex:!0,katex:!0,mermaid:!1,audio:void 0,fancybox:!0,outime:!0,template:'<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>',quiz:{choice:"单选题",multiple:"多选题",true_false:"判断题",essay:"问答题",gap_fill:"填空题",mistake:"错题备注"},ignores:[e=>e.includes("#"),e=>new RegExp(LOCAL.path+"$").test(e),[]]}</script><script src="undefined/undefined" crossorigin="anonymous" fetchpriority="high"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha384-Zm+UU4tdcfAm29vg+MTbfu&#x2F;&#x2F;q5B&#x2F;lInMbMCr4T8c9rQFyOv6PlfQYpB5wItcXWe7" crossorigin="anonymous" fetchpriority="high"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" integrity="sha384-TOxsBplaL96&#x2F;QDWPIUg+ye3v89qSE3s22XNtJMmCeZEep3cVDmXy1zEfZvVv+y2m" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.25" type="module" fetchpriority="high" defer></script></body></html><!-- rebuild by hexo-renderer-multi-next-markdown-it -->