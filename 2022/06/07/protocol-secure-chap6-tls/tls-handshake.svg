<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="634px" preserveAspectRatio="none" style="width:365px;height:634px;background:#FFFFFF;" version="1.1" viewBox="0 0 365 634" width="365px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="30" x2="30" y1="40.2719" y2="594.9841"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="243.5" x2="243.5" y1="40.2719" y2="594.9841"/><rect fill="#E2E2F0" height="34.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="12" y="28.2399">client</text><rect fill="#E2E2F0" height="34.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="5" y="593.9841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="12" y="617.2241">client</text><rect fill="#E2E2F0" height="34.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="216.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="223.5" y="28.2399">server</text><rect fill="#E2E2F0" height="34.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="216.5" y="593.9841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="223.5" y="617.2241">server</text><polygon fill="#181818" points="231.5,71.0959,241.5,75.0959,231.5,79.0959,235.5,75.0959" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="237.5" y1="75.0959" y2="75.0959"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="100.5" y="69.3519">client_hello</text><polygon fill="#181818" points="41.5,106.9199,31.5,110.9199,41.5,114.9199,37.5,110.9199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="242.5" y1="110.9199" y2="110.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="99.5" y="105.1759">server_hello</text><path d="M248,88.0959 L248,116.0959 L328,116.0959 L328,98.0959 L318,88.0959 L248,88.0959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M318,88.0959 L318,98.0959 L328,98.0959 L318,88.0959 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="254" y="108.1759">first stage</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="358.5" x="0" y="134.9199"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="134.9199" y2="134.9199"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="137.9199" y2="137.9199"/><polygon fill="#0000FF" points="41.5,170.744,31.5,174.744,41.5,178.744,37.5,174.744" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="35.5" x2="242.5" y1="174.744" y2="174.744"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="76" y="169">certificate(optional)</text><polygon fill="#0000FF" points="41.5,203.568,31.5,207.568,41.5,211.568,37.5,207.568" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="35.5" x2="242.5" y1="207.568" y2="207.568"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="42.5" y="201.824">server_key_exchange(optional)</text><polygon fill="#0000FF" points="41.5,236.392,31.5,240.392,41.5,244.392,37.5,240.392" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="35.5" x2="242.5" y1="240.392" y2="240.392"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="49.5" y="234.648">certificate_request(optional)</text><polygon fill="#181818" points="41.5,272.216,31.5,276.216,41.5,280.216,37.5,276.216" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="242.5" y1="276.216" y2="276.216"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="80.5" y="270.472">server_hello_done</text><path d="M248,253.392 L248,281.392 L348,281.392 L348,263.392 L338,253.392 L248,253.392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M338,253.392 L338,263.392 L348,263.392 L338,253.392 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="254" y="273.472">second stage</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="358.5" x="0" y="300.216"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="300.216" y2="300.216"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="303.216" y2="303.216"/><polygon fill="#0000FF" points="231.5,336.04,241.5,340.04,231.5,344.04,235.5,340.04" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="30.5" x2="237.5" y1="340.04" y2="340.04"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="76" y="334.296">certificate(optional)</text><polygon fill="#181818" points="231.5,368.864,241.5,372.864,231.5,376.864,235.5,372.864" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="237.5" y1="372.864" y2="372.864"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="73.5" y="367.12">client_key_exchange</text><polygon fill="#0000FF" points="231.5,404.6881,241.5,408.6881,231.5,412.6881,235.5,408.6881" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="30.5" x2="237.5" y1="408.6881" y2="408.6881"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="55.5" y="402.9441">certificate_verify(optional)</text><path d="M248,385.864 L248,413.864 L334,413.864 L334,395.864 L324,385.864 L248,385.864 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M324,385.864 L324,395.864 L334,395.864 L324,385.864 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="254" y="405.9441">third stage</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="358.5" x="0" y="432.6881"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="432.6881" y2="432.6881"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="358.5" y1="435.6881" y2="435.6881"/><polygon fill="#181818" points="231.5,468.5121,241.5,472.5121,231.5,476.5121,235.5,472.5121" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="237.5" y1="472.5121" y2="472.5121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="74.5" y="466.7681">change_cipher_spec</text><polygon fill="#181818" points="231.5,501.3361,241.5,505.3361,231.5,509.3361,235.5,505.3361" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30.5" x2="237.5" y1="505.3361" y2="505.3361"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="112.5" y="499.5921">finished</text><polygon fill="#181818" points="41.5,534.1601,31.5,538.1601,41.5,542.1601,37.5,538.1601" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="242.5" y1="538.1601" y2="538.1601"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="74.5" y="532.4161">change_cipher_spec</text><polygon fill="#181818" points="41.5,569.9841,31.5,573.9841,41.5,577.9841,37.5,573.9841" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="242.5" y1="573.9841" y2="573.9841"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="112.5" y="568.2401">finished</text><path d="M248,551.1601 L248,579.1601 L342,579.1601 L342,561.1601 L332,551.1601 L248,551.1601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M332,551.1601 L332,561.1601 L342,561.1601 L332,551.1601 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="254" y="571.2401">fourth stage</text><!--MD5=[c3019a14a9a94368686a5f6a0cf68fb8]
@startuml
skinparam sequenceMessageAlign center
participant client as c
participant server as s
c -> s: client_hello
s -> c: server_hello
note right: first stage
====
s -[#blue]> c: certificate(optional)
s -[#blue]> c: server_key_exchange(optional)
s -[#blue]> c: certificate_request(optional)
s -> c: server_hello_done
note right: second stage
====
c -[#blue]> s: certificate(optional)
c -> s: client_key_exchange
c -[#blue]> s: certificate_verify(optional)
note right: third stage
====
c -> s: change_cipher_spec
c -> s: finished
s -> c: change_cipher_spec
s -> c: finished
note right: fourth stage
@enduml

PlantUML version 1.2022.4(Sat Apr 09 21:29:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>